# POWER Maintainer: Alexander Baldeck <alex.bldck@gmail.com>
# Maintainer: Laurent Carlier <lordheavym@gmail.com>

pkgname=libclc
pkgver=0.2.0+g8c1dbd5c1e2
pkgrel=1
pkgdesc="Library requirements of the OpenCL C programming language"
arch=('any')
url="https://libclc.llvm.org/"
license=('MIT')
makedepends=('clang' 'llvm' 'python' 'git' 'cmake')
options=('staticlibs')
commit='8c1dbd5c1e2b53e39201b8aefc9c1f2dcb73ea13'
source=("libclc::git+https://github.com/llvm/llvm-project.git#commit=${commit}")
md5sums=('SKIP')

pkgver() {
  cd libclc/libclc

  echo 0.2.0+$(git describe --always | sed 's@.*-@@g')
}

build() {
  cd libclc/libclc
  cmake -DCMAKE_INSTALL_PREFIX=/usr .
  make
}

package() {
  cd libclc/libclc
  
  make install DESTDIR="$pkgdir"
  install -Dm644 LICENSE.TXT "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}

